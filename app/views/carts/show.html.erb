<!DOCTYPE html>
<html>
<head>
  <title>Cart Page</title>
  <meta name="csrf-token" content="<%= form_authenticity_token %>">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
<div class="min-h-screen p-6 bg-gray-100">
  <h1 class="text-3xl font-bold mb-6">Cart Page</h1>
  <% if flash[:notice] %>
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative" role="alert">
      <span class="block sm:inline"><%= flash[:notice] %></span>
    </div>
  <% end %>

  <% if flash[:alert] %>
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
      <span class="block sm:inline"><%= flash[:alert] %></span>
    </div>
  <% end %>
  <br>

  <div id="errorContainer"></div>
  <div id="cart-items" class="space-y-4">
    <% if @cart_items.any? %>
      <% @cart_items.each do |item| %>
        <div class="bg-white p-4 rounded shadow flex justify-between items-center">

          <div>
            <h3 class="text-lg font-semibold"><%= item.product.name %></h3>
            <p>Price: $<%= (item.product.price / 100.0).round(2) %> </p>
            <p>Size / Color: <%= item.size %></p>
            <p>Quantity: <%= item.quantity %></p>
            <p>Subtotal: $<%= (item.product.price * item.quantity / 100.0).round(2) %></p>
          </div>
          <div class="flex space-x-2">
            <%= button_to 'Remove', remove_item_cart_path(item), method: :delete, class: "bg-red-500 text-white px-2 py-1 rounded" %>
            <%= button_to '+', increase_quantity_cart_path(item), method: :patch, class: "bg-green-500 text-white px-2 py-1 rounded" %>
            <%= button_to '-', decrease_quantity_cart_path(item), method: :patch, class: "bg-yellow-500 text-white px-2 py-1 rounded" %>
          </div>
        </div>
      <% end %>
    <% else %>
      <p>No items in cart</p>
    <% end %>
  </div>
  <div class="mt-4 font-medium" id="total">
    Total: $<%= (@cart_items.sum { |item| item.product.price * item.quantity } / 100.0).round(2) %>
  </div>
<div class="flex justify-between mt-6">
  <%= button_to 'Check out', checkout_cart_path, method: :post, class: "py-2 px-10 bg-blue-500 hover:bg-blue-600 rounded text-white" %>
  <%= button_to 'Clear Cart', clear_cart_path, method: :delete, class: "py-2 px-10 bg-pink-500 hover:bg-red-600 rounded text-white" %>
  <%= link_to "Browse All", products_path, class: "py-2 px-10 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded" %>
</div>
</div>
</body>
</html>


